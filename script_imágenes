function sacarLinksDeCarpeta() {
  // ðŸ”¹ ConfiguraciÃ³n
  var ID_CARPETA = "TU_ID_DE_CARPETA";
  var NOMBRE_HOJA = "TU_NOMBRE_DE_HOJA";        
  var TAMANIO_IMG = "s2200";          

  // ðŸ”¹ Acceso a carpeta
  var carpeta = DriveApp.getFolderById(ID_CARPETA); 
  var archivos = carpeta.getFiles();

  // ðŸ”¹ Buscar hoja o crearla si no existe
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var hoja = ss.getSheetByName(NOMBRE_HOJA);
  if (!hoja) {
    hoja = ss.insertSheet(NOMBRE_HOJA);
  } else {
    hoja.clear();
  }

  // Cabeceras
  hoja.getRange(1, 1).setValue("Nombre");
  hoja.getRange(1, 2).setValue("Link Imagen");
  
  var fila = 2;
  
  while (archivos.hasNext()) {
    var archivo = archivos.next();
    var id = archivo.getId();
    
    // Nombre sin extensiÃ³n
    var nombreOriginal = archivo.getName();
    var nombreSinExtension = nombreOriginal.replace(/\.[^\.]+$/, ""); 
    
    // Forzar que Google Sheets lo trate como texto para mantener los ceros
    hoja.getRange(fila, 1).setValue("'" + nombreSinExtension); 

    // Construir link en formato lh3.googleusercontent.com
    var linkImagen = "https://lh3.googleusercontent.com/d/" + id + "=" + TAMANIO_IMG + "?authuser=0";
    hoja.getRange(fila, 2).setValue(linkImagen);
    
    fila++;
  }
}
